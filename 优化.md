## 优化

参考文档: 

https://blog.csdn.net/dodod2012/article/details/81744526

### 分析

1、如何处理大量连接的问题（物理问题，不用解决）

集群，部署多个节点, 通过负载均衡，打散到不同的节点

2、如何处理大批量数据同时进行推送的问题

减小网络小包的请求，在前端层面进行控制，设置一个中央管理器，维护各个请求，设置指定时长内定时集中推送
小包 合 大包（将一秒内N条消息合并成1条消息，合并后，每秒推送数等于在线连接数）

3、如何保证线程安全

参考 Golang 的 map 线程安全

4、Json编码非常耗费CPU资源（如何解决json编码性能问题）

如上中的 N条消息合并，后，多次json编码转为 单次编码

5、如何处理用户连接断开，重新连接持续推送的问题

持久化数据到redis 或者 mysql中。标识数据推送状态即可。前提必须保证 读写 可能导致的并发问题